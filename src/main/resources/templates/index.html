<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" xmlns:sec="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <meta name="viewport" content="width=device-width, initial-scale=1">
</head>

<style>


    @media only screen and (max-width:800px) {
            #no-more-tables tbody,
            #no-more-tables tr,
            #no-more-tables td {
                display: block;
            }
            #no-more-tables thead tr {
                position: absolute;
                top: -9999px;
                left: -9999px;
            }
            #no-more-tables td {
                position: relative;
                padding-left: 50%;
                border: none;
                border-bottom: 1px solid #eee;
            }
            #no-more-tables td:before {
                content: attr(data-title);
                position: absolute;
                left: 6px;
                font-weight: bold;
            }
            #no-more-tables tr {
                border-bottom: 1px solid #ccc;
            }
        }
</style>
<body>
<nav th:replace="fragments/nav">

</nav>

<div class="container mb-4">

    <div class="container mt-3">

        <div  class="col-sm mt-3 mb-3" style="font-size: 21px">
            <form th:action="@{/}" >
                <input type="hidden" name="sortField" th:value="${sortField}">
                <input type="hidden" name="sortDir" th:value="${sortDir}">
                <b>Filter:</b>
                <label for="cats">Category:</label>
                <select id="cats" name="keyWord" th:value="${keyWord}">
                    <option value="" selected disabled hidden>Select</option>
                    <option th:value="'Paints'" th:text="Paints">Paints</option>
                    <option th:value="'Neckless'" th:text="Neckless">NeckLess</option>
                    <option th:value="'Bracelet'" th:text="Bracelet">Bracelet</option>
                </select>
                &nbsp;
                <button class="btn btn-primary" > Search </button>
                &nbsp;
                <button class="btn btn-danger"  onclick="clearFilter()">Clear</button>
            </form>
        </div>


    </div>
    <div class="card mt-2">
        <h2 style="color:green" th:if="${finalizeDone}==true"> You have successfully completed your order
        </h2>

        <div class="card-block table-responsive" id="no-more-tables">
            <table class="table table-hover">
                <thead>
                <tr class="bg-warning">
                    <th data-title="ID" sec:authorize="hasRole('ADMIN')" >ID</th>
                    <th data-title="Photo">Photo</th>
                    <th data-title="Producer">Producer</th>
                    <th data-title="Name">Name</th>
                    <th data-title="Price"><a th:href="@{'/products/page/' + ${currentPage} + '?sortField=price&sortDir=' + ${reverseSortDir}+ ${keyWord!=null ? '&keyWord=' + keyWord : ''}}">Price</a></th>
                    <th data-title="Quantity" sec:authorize="hasRole('ADMIN')">Quantity</th>
                </tr>
                </thead>
                <tbody>

                <tr sec:authorize="isAuthenticated()" th:each="product : ${products}" th:onclick="'javascript:location.href=\'' + @{'/product/' + ${product.id}} + '\''">
                    <td data-title="ID" sec:authorize="hasRole('ADMIN')" th:text="${product.id}">ID </td>
                    <td data-title="Photo">  <img th:src="${product.imageSource}" style="height:200px;max-width:300px;width: expression(this.width > 500 ? 500: true);"></td>
                    <td data-title="Producer"  th:text="${product.producer}">Producer</td>
                    <td data-title="Name" th:text="${product.name}">Name</td>
                    <td data-title="Price" th:text="${product.price}">Price</td>
                    <td data-title="Quantity available" sec:authorize="hasRole('ADMIN')" th:text="${product.stock}">Quantity available</td>

                </tr>
                <tr sec:authorize="!isAuthenticated()"  th:each="product : ${products}" th:onclick="begin()">
                    <td data-title="Image">  <img th:src="${product.imageSource}" style="height:200px;max-width:300px;width: expression(this.width > 500 ? 500: true);"></td>
                    <td data-title="Producer" th:text="${product.producer}">Producer</td>
                    <td data-title="Name" th:text="${product.name}">Name</td>
                    <td data-title="Price" th:text="${product.price}">Price</td>
                </tr>
                </tbody>
            </table>
        <hr/>

        </div>
    </div>
    <div class="container mb-3" th:if = "${totalPages>1}">
        <div class="row justify-content-center">
            <div class="col-2 text-primary">
                Total rows: [[ ${totalItems}]]    -

                <span th:each="i: ${#numbers.sequence(1, totalPages)}">
                      <a th:if="${currentPage != i}" th:href="@{'/products/page/' + ${i} + '?sortField=' + ${sortField} + '&sortDir=' + ${sortDir}+ ${keyWord!=null ? '&keyWord=' + keyWord : ''}}">[[${i}]]</a>
                        <span th:unless="${currentPage != i}">[[${i}]]</span>
					</span>
            </div>

            <div class="col-2 text-primary">
                <a th:if="${currentPage < totalPages}" th:href="@{'/products/page/' + ${currentPage + 1}+ '?sortField=' + ${sortField} + '&sortDir=' + ${sortDir}+ ${keyWord!=null ? '&keyWord=' + keyWord : ''}}">Next</a>
                <span th:unless="${currentPage < totalPages}">Next</span>
            </div>
            <div class="col-2 text-primary">
                <a th:if="${currentPage < totalPages}" th:href="@{'/products/page/' + ${totalPages} + '?sortField=' + ${sortField} + '&sortDir=' + ${sortDir}+ ${keyWord!=null ? '&keyWord=' + keyWord : ''}}">Last</a>
                <span th:unless="${currentPage < totalPages}">Last</span>
            </div>
        </div>
    </div>
</div>


</footer>
<script type="text/javascript">

            function begin(){
            window.location='/login.html';
            }


           function clearFilter(){
           window.location='/';
            }

</script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js" integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js" integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF" crossorigin="anonymous"></script>

</body>
</html>
